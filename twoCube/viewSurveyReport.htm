<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>twoCube - Analytics</title>
    <script src="http://www.google.com/jsapi" type="text/javascript"></script>
    <link rel="stylesheet" href="http://www.jacklmoore.com/colorbox/example1/colorbox.css" /> 
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://www.jacklmoore.com/colorbox/colorbox/jquery.colorbox.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
    <script language="javascript" type="text/javascript" src="Scripts/jquery.jqplot.min.js"></script>
    <script type="text/javascript" src="Scripts/plugins/jqplot.pieRenderer.js"></script>
    <script type="text/javascript" src="Scripts/plugins/jqplot.barRenderer.js"></script>
    <script type="text/javascript" src="Scripts/plugins/jqplot.categoryAxisRenderer.js"></script>
    <script type="text/javascript" src="Scripts/plugins/jqplot.categoryAxisRenderer.js"></script>
    <script type="text/javascript" src="../src/plugins/jqplot.donutRenderer.min.js"></script>
    <link rel="Stylesheet" type="text/css" href="Styles/jquery.jqplot.min.css" />
    <link href="css/style.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="css/ddsmoothmenu.css" />
    <script type="text/javascript" src="js/scripts.js"></script>
    <!--<script type="text/javascript">
        google.load("jquery", "1.4.2");
        google.load("jqueryui", "1.7.2");
    </script>-->
</head>
<body onload="onload()">
    <div id="wrapper">
	<div id="header">
        <div id="site_title"><h1><a href="#"></a></h1></div>
       <!-- end of menu -->
        <div class="cleaner"></div>
    </div> <!-- end of header -->
    <div id="menu" class="ddsmoothmenu">
        </div> <br/>
     <!-- Start Top -->
		<div id="maindiv" align="center" style="width:100%;">
    </div>
    <div class="code prettyprint">
        <pre class="code prettyprint brush: js"></pre>
        <style type="text/css">
            .note
            {
                font-size: 0.8em;
            }
            .jqplot-yaxis-tick
            {
                white-space: nowrap;
            }
        </style>
    <!-- End Top -->
    <div class="cleaner"></div>
	</div> <!-- end of middle -->
    
    <!-- end of main -->
</div> <!-- wrapper -->

<div id="footer_wrapper">
	<div id="footer"></div>
</div>
</div>
    
        <script type="text/javascript">
            var data = localStorage.getItem("twocubeSSO") || 0;
            var datastuff = [];
            var browstuff = [];
            var osstuff = [];
            var piestuff = [];
            var listpiestuff = [];
            var pie_i = 0;
            var barstuff = [];
            var listbarstuff = [];
            var bar_i = 0;
            var colstuff = [];
            var listcolstuff = [];
            var col_i = 0;
            //google.load('visualization', '1', {packages: ['geochart']});
            google.load('visualization', '1', {packages: ['geochart', 'corechart']});


            function geoChart() {
              var data = google.visualization.arrayToDataTable(datastuff);
    
              var geochart = new google.visualization.GeoChart(
                  document.getElementById('visualization'));
              geochart.draw(data, {width: 556, height: 347});
            }

            function browserChart() {
                var data = google.visualization.arrayToDataTable(browstuff);
    
                  var brow = new google.visualization.PieChart(document.getElementById('broswerStat'));
                  brow.draw(data, {width: 556, height: 347});
            }

            function osChart() {
                var data = google.visualization.arrayToDataTable(osstuff);
    
                  var os = new google.visualization.PieChart(document.getElementById('osStat'));
                  os.draw(data, {width: 556, height: 347});
            }


            function drawPie() {
                for (var i=0; i<listpiestuff.length; i++)
                {
                var data = google.visualization.arrayToDataTable(listpiestuff[i]);
                
                  var pie = new google.visualization.PieChart(document.getElementById('pieStat'+i));
                  pie.draw(data, {width: 556, height: 347});
                }
            }

            function drawBar() {
                for (var i=0; i<listbarstuff.length; i++)
                {
                var data = google.visualization.arrayToDataTable(listbarstuff[i]);
                
                  var bar = new google.visualization.BarChart(document.getElementById('barStat'+i));
                  bar.draw(data, {width: 556, height: 347});
                }
          }


          function drawCol() {
              for (var i = 0; i < listcolstuff.length; i++) {
                  var data = google.visualization.arrayToDataTable(listcolstuff[i]);

                  var col = new google.visualization.ColumnChart(document.getElementById('colStat' + i));
                  col.draw(data, { width: 556, height: 347 });
              }
          }


            $.urlParam = function (name) {
                var results = new RegExp('[\\?&]' + name + '=([^&#]*)').exec(window.location.href);
                return results[1] || 0;
            }
            $.getJSON("./Services/SurveyResults.asmx/getSurvey",
          {
              id: $.urlParam('id'),
              memberHash: data
          },
          function (data) {
              $("<u><h1>" + data.surveyTitle + "</h1></u>").appendTo("#maindiv");
              if (data.surveyDescription != null) {
                  $("<h4>" + data.surveyDescription + "</h4>").appendTo("#maindiv");
              }
              $("<h4> Number of Repondents: " + data.noOfRespondents + "</h4>").appendTo("#maindiv");
              $("<h4> Average time taken for " + data.noOfRespondents + " respondent(s) to do the survey: " + data.avgTime + " seconds </h4><br>").appendTo("#maindiv");

              $("<h4>Respondent Geographic Location: </h4>").appendTo("#maindiv");
              $("<div id=\"visualization\"></div>").appendTo("#maindiv");
              $("<br>").appendTo("#maindiv");


              var datastuffheader = ['Country', 'Respondents'];
              datastuff.push(datastuffheader);
              $.each(data.countryCode, function (countryNumber, country) {
                  var datastuffitem = [];
                  datastuffitem.push(country.key);
                  datastuffitem.push(country.value);
                  datastuff.push(datastuffitem);
              });

              google.setOnLoadCallback(geoChart);

              $("<h4>Respondent Browser Type: </h4>").appendTo("#maindiv");
              $("<div id=\"broswerStat\"></div>").appendTo("#maindiv");
              $("<br>").appendTo("#maindiv");

              var browstuffheader = ['Browser', 'Respondents'];
              browstuff.push(browstuffheader);
              $.each(data.browserBrowser, function (respBrowser, browser) {
                  var browstuffitem = [];
                  browstuffitem.push(browser.key);
                  browstuffitem.push(browser.value);
                  browstuff.push(browstuffitem);
              });

              google.setOnLoadCallback(browserChart);

              $("<h4>Respondent Operating System: </h4>").appendTo("#maindiv");
              $("<div id=\"osStat\"></div>").appendTo("#maindiv");
              $("<br>").appendTo("#maindiv");

              var osstuffheader = ['Operating System', 'Respondents'];
              osstuff.push(osstuffheader);
              $.each(data.browserOS, function (respOS, os) {
                  var osstuffitem = [];
                  osstuffitem.push(os.key);
                  osstuffitem.push(os.value);
                  osstuff.push(osstuffitem);
              });

              google.setOnLoadCallback(osChart);

              $.each(data.questionList, function (question, questionList) {
                  // $("<h2>" + questionList.questionTitle + "</h2>").appendTo("#maindiv");
                  $("<br>").appendTo("#maindiv");
                  //date, numerical input, text, textarea
                  if (questionList.questionType == 2 || questionList.questionType == 3 || questionList.questionType == 4 || questionList.questionType == 6 || questionList.questionType == 7) {
                      $("<div id=\"list" + question + "\"></div>").appendTo("#maindiv");

                      $("<h4>" + (question + 1) + ". " + questionList.questionTitle + "</h4><p>").appendTo("#list" + question);

                      $.each(questionList.optionList, function (option, optionList) {
                          $("<div style=\"width:585px; border:1px solid grey;\"><font color=\"#585858\"><h5>" + ((optionList.noOfRespondents / data.noOfRespondents) * 100).toFixed(1) + "% of the respondents responded: " + "<b>" + optionList.responseStr + "</b></font></h5></div>").appendTo("#list" + question);
                          //  $("<table cellpadding=\"8\" cellspacing=\"0\" border=\"1\" width=\"585px\"><tr><td><h5>" + optionList.noOfRespondents + " responded: " + optionList.responseStr + "</h5></td></tr></table>").appendTo("#list"+question);
                      });

                  }

                  else if (questionList.questionType == 0 || questionList.questionType == 10) { //radio button, scale radio
                      //$("<div id=\"pielist" + question + "\"></div>").appendTo("#maindiv"); 
                      var piestuff = [];
                      $("<h4>" + (question + 1) + ". " + questionList.questionTitle + "</h4>").appendTo("#maindiv");
                      $("<div id=\"pieStat" + pie_i + "\"></div>").appendTo("#maindiv");
                      $(function () {
                          var piestuffheader = ['Option', 'No of Respondents'];
                          piestuff.push(piestuffheader);
                          $.each(questionList.optionList, function (option, optionList) {
                              var piestuffitem = [];
                              piestuffitem.push(optionList.optionTitle);
                              piestuffitem.push(optionList.noOfRespondents);
                              piestuff.push(piestuffitem);
                          });
                          $(google.setOnLoadCallback(drawPie));
                      })
                      listpiestuff.push(piestuff);
                      pie_i++;
                  }

                  else if (questionList.questionType == 1) { //checkbox
                      var barstuff = [];
                      $("<h4>" + (question + 1) + ". " + questionList.questionTitle + "</h4>").appendTo("#maindiv");
                      $("<div id=\"barStat" + bar_i + "\"></div>").appendTo("#maindiv");
                      $(function () {
                          var barstuffheader = ['Option', 'No of Respondents'];
                          barstuff.push(barstuffheader);
                          $.each(questionList.optionList, function (option, optionList) {
                              var barstuffitem = [];
                              barstuffitem.push(optionList.optionTitle);
                              barstuffitem.push(optionList.noOfRespondents);
                              barstuff.push(barstuffitem);
                          });
                          $(google.setOnLoadCallback(drawBar));
                      })
                      listbarstuff.push(barstuff);
                      bar_i++;
                  }

                  else if (questionList.questionType == 5) { //horiontal radio button
                      var colstuff = [];
                      $("<h4>" + (question + 1) + ". " + questionList.questionTitle + "</h4>").appendTo("#maindiv");
                      $("<div id=\"colStat" + col_i + "\"></div>").appendTo("#maindiv");
                      $(function () {
                          var colstuffheader = ['Option', 'No of Respondents'];
                          colstuff.push(colstuffheader);
                          $.each(questionList.optionList, function (option, optionList) {
                              var colstuffitem = [];
                              colstuffitem.push(optionList.optionTitle);
                              colstuffitem.push(optionList.noOfRespondents);
                              colstuff.push(colstuffitem);
                          });
                          $(google.setOnLoadCallback(drawCol));
                      })
                      listcolstuff.push(colstuff);
                      col_i++;
                  } 
              });
    });


         

            
    

</script>
</body>
</html>
